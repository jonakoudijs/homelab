---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: slskd
  labels:
    app: slskd
spec:
  replicas: 1
  selector:
    matchLabels:
      app: slskd
  template:
    metadata:
      labels:
        app: slskd
    spec:
      containers:
        - name: slskd
          image: docker.io/slskd/slskd:latest
          imagePullPolicy: IfNotPresent
          ports:
            - containerPort: 5030
            - containerPort: 5031
            - containerPort: 50300
          env:
            - name: SLSKD_REMOTE_CONFIGURATION
              value: "true"
          volumeMounts:
            # Soulseek
            - mountPath: /app
              name: slskd-data
            # Shares
            - mountPath: /shares/audiobooks
              name: audiobookshelf-audiobooks
            - mountPath: /shares/music
              name: swing-music-data
      volumes:
        # Soulseek
        - name: slskd-data
          persistentVolumeClaim:
            claimName: slskd-data
        # Shares
        - name: audiobookshelf-audiobooks
          persistentVolumeClaim:
            claimName: audiobookshelf-audiobooks
        - name: swing-music-data
          persistentVolumeClaim:
            claimName: swing-music-data
